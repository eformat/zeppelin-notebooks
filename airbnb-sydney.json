{"paragraphs":[{"text":"%pyspark\nfrom pyspark.sql.types import *\nfrom pyspark.sql import functions \nimport pandas as pd\n\npath = \"http://data.insideairbnb.com/australia/nsw/sydney/2016-01-03/visualisations/listings.csv\"\ndata = pd.read_csv(path, parse_dates=['last_review'], infer_datetime_format=True, verbose=True, engine='c', na_values='NULL', keep_default_na=False)\ndf = sqlContext.createDataFrame(data)\ndf.registerTempTable(\"airbnb\")\n","dateUpdated":"2016-08-05T01:19:07+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470359922504_300555762","id":"20160804-214117_288961697","result":{"code":"SUCCESS","type":"TEXT","msg":"Tokenization took: 6032.38 ms\nType conversion took: 70.80 ms\nParser memory cleanup took: 0.02 ms\n"},"dateCreated":"2016-08-05T01:18:42+0000","dateStarted":"2016-08-05T01:19:07+0000","dateFinished":"2016-08-05T01:19:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8672"},{"text":"%sql\nSELECT AVG(price) avg_price, neighbourhood\nFROM airbnb\nGROUP BY neighbourhood\nORDER BY 1 DESC\n\n","dateUpdated":"2016-08-05T01:19:25+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","tableHide":false,"graph":{"mode":"multiBarChart","height":324,"optionOpen":false,"keys":[{"name":"neighbourhood","index":1,"aggr":"sum"}],"values":[{"name":"avg_price","index":0,"aggr":"sum"}],"groups":[],"scatter":{"yAxis":{"name":"avg_price","index":0,"aggr":"sum"},"xAxis":{"name":"neighbourhood","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470359922505_300171013","id":"20160804-225746_1508097756","result":{"code":"SUCCESS","type":"TABLE","msg":"avg_price\tneighbourhood\n106.9010989010989\tAshfield\n88.66666666666667\tBurwood\n97.44444444444444\tCampbelltown\n196.96190476190475\tLeichhardt\n171.85714285714286\tLiverpool\n161.21311475409837\tSutherland Shire\n161.7173913043478\tKu-Ring-Gai\n104.13872832369943\tRyde\n111.79591836734694\tHornsby\n134.56\tThe Hills Shire\n403.896\tMosman\n104.28571428571429\tBankstown\n102.77005347593582\tRockdale\n310.175\tHunters Hill\n168.53781512605042\tLane Cove\n123.21192052980132\tCanada Bay\n105.8157894736842\tCity Of Kogarah\n443.6989247311828\tPittwater\n186.79617834394904\tNorth Sydney\n79.5\tFairfield\n85.65384615384616\tBlacktown\n151.82758620689654\tAuburn\n60.878787878787875\tHolroyd\n81.0909090909091\tStrathfield\n88.04255319148936\tHurstville\n248.47568208778173\tManly\n244.58582089552237\tWarringah\n178.46666666666667\tWilloughby\n114.28400597907324\tMarrickville\n84.37903225806451\tParramatta\n106.85714285714286\tCanterbury\n255.7180043383948\tWoollahra\n191.4422964264792\tRandwick\n92.6\tCamden\n244.52363141788507\tWaverley\n125.85714285714286\tBotany Bay\n163.99295432458698\tSydney\n56.666666666666664\tPenrith\n","comment":"","msgTable":[[{"key":"neighbourhood","value":"106.9010989010989"},{"key":"neighbourhood","value":"Ashfield"}],[{"value":"88.66666666666667"},{"value":"Burwood"}],[{"value":"97.44444444444444"},{"value":"Campbelltown"}],[{"value":"196.96190476190475"},{"value":"Leichhardt"}],[{"value":"171.85714285714286"},{"value":"Liverpool"}],[{"value":"161.21311475409837"},{"value":"Sutherland Shire"}],[{"value":"161.7173913043478"},{"value":"Ku-Ring-Gai"}],[{"value":"104.13872832369943"},{"value":"Ryde"}],[{"value":"111.79591836734694"},{"value":"Hornsby"}],[{"value":"134.56"},{"value":"The Hills Shire"}],[{"value":"403.896"},{"value":"Mosman"}],[{"value":"104.28571428571429"},{"value":"Bankstown"}],[{"value":"102.77005347593582"},{"value":"Rockdale"}],[{"value":"310.175"},{"value":"Hunters Hill"}],[{"value":"168.53781512605042"},{"value":"Lane Cove"}],[{"value":"123.21192052980132"},{"value":"Canada Bay"}],[{"value":"105.8157894736842"},{"value":"City Of Kogarah"}],[{"value":"443.6989247311828"},{"value":"Pittwater"}],[{"value":"186.79617834394904"},{"value":"North Sydney"}],[{"value":"79.5"},{"value":"Fairfield"}],[{"value":"85.65384615384616"},{"value":"Blacktown"}],[{"value":"151.82758620689654"},{"value":"Auburn"}],[{"value":"60.878787878787875"},{"value":"Holroyd"}],[{"value":"81.0909090909091"},{"value":"Strathfield"}],[{"value":"88.04255319148936"},{"value":"Hurstville"}],[{"value":"248.47568208778173"},{"value":"Manly"}],[{"value":"244.58582089552237"},{"value":"Warringah"}],[{"value":"178.46666666666667"},{"value":"Willoughby"}],[{"value":"114.28400597907324"},{"value":"Marrickville"}],[{"value":"84.37903225806451"},{"value":"Parramatta"}],[{"value":"106.85714285714286"},{"value":"Canterbury"}],[{"value":"255.7180043383948"},{"value":"Woollahra"}],[{"value":"191.4422964264792"},{"value":"Randwick"}],[{"value":"92.6"},{"value":"Camden"}],[{"value":"244.52363141788507"},{"value":"Waverley"}],[{"value":"125.85714285714286"},{"value":"Botany Bay"}],[{"value":"163.99295432458698"},{"value":"Sydney"}],[{"value":"56.666666666666664"},{"value":"Penrith"}]],"columnNames":[{"name":"avg_price","index":0,"aggr":"sum"},{"name":"neighbourhood","index":1,"aggr":"sum"}],"rows":[["106.9010989010989","Ashfield"],["88.66666666666667","Burwood"],["97.44444444444444","Campbelltown"],["196.96190476190475","Leichhardt"],["171.85714285714286","Liverpool"],["161.21311475409837","Sutherland Shire"],["161.7173913043478","Ku-Ring-Gai"],["104.13872832369943","Ryde"],["111.79591836734694","Hornsby"],["134.56","The Hills Shire"],["403.896","Mosman"],["104.28571428571429","Bankstown"],["102.77005347593582","Rockdale"],["310.175","Hunters Hill"],["168.53781512605042","Lane Cove"],["123.21192052980132","Canada Bay"],["105.8157894736842","City Of Kogarah"],["443.6989247311828","Pittwater"],["186.79617834394904","North Sydney"],["79.5","Fairfield"],["85.65384615384616","Blacktown"],["151.82758620689654","Auburn"],["60.878787878787875","Holroyd"],["81.0909090909091","Strathfield"],["88.04255319148936","Hurstville"],["248.47568208778173","Manly"],["244.58582089552237","Warringah"],["178.46666666666667","Willoughby"],["114.28400597907324","Marrickville"],["84.37903225806451","Parramatta"],["106.85714285714286","Canterbury"],["255.7180043383948","Woollahra"],["191.4422964264792","Randwick"],["92.6","Camden"],["244.52363141788507","Waverley"],["125.85714285714286","Botany Bay"],["163.99295432458698","Sydney"],["56.666666666666664","Penrith"]]},"dateCreated":"2016-08-05T01:18:42+0000","dateStarted":"2016-08-05T01:19:25+0000","dateFinished":"2016-08-05T01:19:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8673"},{"text":"%sql\nSELECT AVG(price) avg_price, minimum_nights\nFROM airbnb\nGROUP BY minimum_nights\nORDER BY 1 DESC\n","dateUpdated":"2016-08-05T01:21:35+0000","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"minimum_nights","index":1,"aggr":"sum"}],"values":[{"name":"avg_price","index":0,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"avg_price","index":0,"aggr":"sum"},"yAxis":{"name":"minimum_nights","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470359922505_300171013","id":"20160805-003012_1736093544","result":{"code":"SUCCESS","type":"TABLE","msg":"avg_price\tminimum_nights\n123.0\t40\n195.0\t50\n121.0\t45\n111.8\t60\n156.0\t78\n949.8333333333334\t90\n85.0\t92\n64.0\t130\n1251.0\t365\n140.33333333333334\t180\n233.82939362795477\t4\n211.06306306306305\t3\n273.33400946585533\t5\n142.75944753500863\t1\n180.52402676399026\t2\n239.88841201716738\t6\n223.13636363636363\t9\n316.54655870445345\t7\n212.73170731707316\t8\n242.34718826405867\t14\n103.11111111111111\t13\n154.52173913043478\t12\n107.11538461538461\t15\n2573.4\t11\n134.5\t16\n234.02392344497608\t10\n114.5\t19\n132.66666666666666\t17\n108.47826086956522\t20\n328.3333333333333\t18\n167.33928571428572\t21\n85.0\t22\n74.0909090909091\t25\n140.0\t27\n100.0\t26\n171.0\t28\n82.0\t23\n225.78947368421052\t30\n","comment":"","msgTable":[[{"key":"minimum_nights","value":"123.0"},{"key":"minimum_nights","value":"40"}],[{"value":"195.0"},{"value":"50"}],[{"value":"121.0"},{"value":"45"}],[{"value":"111.8"},{"value":"60"}],[{"value":"156.0"},{"value":"78"}],[{"value":"949.8333333333334"},{"value":"90"}],[{"value":"85.0"},{"value":"92"}],[{"value":"64.0"},{"value":"130"}],[{"value":"1251.0"},{"value":"365"}],[{"value":"140.33333333333334"},{"value":"180"}],[{"value":"233.82939362795477"},{"value":"4"}],[{"value":"211.06306306306305"},{"value":"3"}],[{"value":"273.33400946585533"},{"value":"5"}],[{"value":"142.75944753500863"},{"value":"1"}],[{"value":"180.52402676399026"},{"value":"2"}],[{"value":"239.88841201716738"},{"value":"6"}],[{"value":"223.13636363636363"},{"value":"9"}],[{"value":"316.54655870445345"},{"value":"7"}],[{"value":"212.73170731707316"},{"value":"8"}],[{"value":"242.34718826405867"},{"value":"14"}],[{"value":"103.11111111111111"},{"value":"13"}],[{"value":"154.52173913043478"},{"value":"12"}],[{"value":"107.11538461538461"},{"value":"15"}],[{"value":"2573.4"},{"value":"11"}],[{"value":"134.5"},{"value":"16"}],[{"value":"234.02392344497608"},{"value":"10"}],[{"value":"114.5"},{"value":"19"}],[{"value":"132.66666666666666"},{"value":"17"}],[{"value":"108.47826086956522"},{"value":"20"}],[{"value":"328.3333333333333"},{"value":"18"}],[{"value":"167.33928571428572"},{"value":"21"}],[{"value":"85.0"},{"value":"22"}],[{"value":"74.0909090909091"},{"value":"25"}],[{"value":"140.0"},{"value":"27"}],[{"value":"100.0"},{"value":"26"}],[{"value":"171.0"},{"value":"28"}],[{"value":"82.0"},{"value":"23"}],[{"value":"225.78947368421052"},{"value":"30"}]],"columnNames":[{"name":"avg_price","index":0,"aggr":"sum"},{"name":"minimum_nights","index":1,"aggr":"sum"}],"rows":[["123.0","40"],["195.0","50"],["121.0","45"],["111.8","60"],["156.0","78"],["949.8333333333334","90"],["85.0","92"],["64.0","130"],["1251.0","365"],["140.33333333333334","180"],["233.82939362795477","4"],["211.06306306306305","3"],["273.33400946585533","5"],["142.75944753500863","1"],["180.52402676399026","2"],["239.88841201716738","6"],["223.13636363636363","9"],["316.54655870445345","7"],["212.73170731707316","8"],["242.34718826405867","14"],["103.11111111111111","13"],["154.52173913043478","12"],["107.11538461538461","15"],["2573.4","11"],["134.5","16"],["234.02392344497608","10"],["114.5","19"],["132.66666666666666","17"],["108.47826086956522","20"],["328.3333333333333","18"],["167.33928571428572","21"],["85.0","22"],["74.0909090909091","25"],["140.0","27"],["100.0","26"],["171.0","28"],["82.0","23"],["225.78947368421052","30"]]},"dateCreated":"2016-08-05T01:18:42+0000","dateStarted":"2016-08-05T01:20:55+0000","dateFinished":"2016-08-05T01:21:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8674"},{"text":"%sql\nSELECT AVG(price) avg_price, minimum_nights, room_type\nFROM airbnb\nWHERE neighbourhood in ('Pittwater')\nGROUP BY room_type, minimum_nights\nORDER BY 1 DESC\n","dateUpdated":"2016-08-05T01:42:45+0000","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"minimum_nights","index":1,"aggr":"sum"}],"values":[{"name":"avg_price","index":0,"aggr":"sum"}],"groups":[{"name":"room_type","index":2,"aggr":"sum"}],"scatter":{"xAxis":{"name":"avg_price","index":0,"aggr":"sum"},"yAxis":{"name":"minimum_nights","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{"room_type":"Private room"},"forms":{}},"jobName":"paragraph_1470359922507_300940511","id":"20160805-005121_1554786668","result":{"code":"SUCCESS","type":"TABLE","msg":"avg_price\tminimum_nights\troom_type\n141.5744680851064\t1\tPrivate room\n150.44444444444446\t2\tPrivate room\n66.0\t3\tPrivate room\n103.33333333333333\t4\tPrivate room\n86.0\t5\tPrivate room\n149.0\t7\tPrivate room\n110.0\t14\tPrivate room\n433.3496932515337\t2\tEntire home/apt\n397.4342105263158\t1\tEntire home/apt\n429.0\t3\tEntire home/apt\n561.6896551724138\t4\tEntire home/apt\n487.5348837209302\t5\tEntire home/apt\n786.0\t6\tEntire home/apt\n672.525\t7\tEntire home/apt\n721.25\t10\tEntire home/apt\n788.3846153846154\t14\tEntire home/apt\n96.0\t1\tShared room\n750.0\t21\tEntire home/apt\n","comment":"","msgTable":[[{"key":"minimum_nights","value":"141.5744680851064"},{"key":"minimum_nights","value":"1"},{"key":"minimum_nights","value":"Private room"}],[{"key":"room_type","value":"150.44444444444446"},{"key":"room_type","value":"2"},{"key":"room_type","value":"Private room"}],[{"value":"66.0"},{"value":"3"},{"value":"Private room"}],[{"value":"103.33333333333333"},{"value":"4"},{"value":"Private room"}],[{"value":"86.0"},{"value":"5"},{"value":"Private room"}],[{"value":"149.0"},{"value":"7"},{"value":"Private room"}],[{"value":"110.0"},{"value":"14"},{"value":"Private room"}],[{"value":"433.3496932515337"},{"value":"2"},{"value":"Entire home/apt"}],[{"value":"397.4342105263158"},{"value":"1"},{"value":"Entire home/apt"}],[{"value":"429.0"},{"value":"3"},{"value":"Entire home/apt"}],[{"value":"561.6896551724138"},{"value":"4"},{"value":"Entire home/apt"}],[{"value":"487.5348837209302"},{"value":"5"},{"value":"Entire home/apt"}],[{"value":"786.0"},{"value":"6"},{"value":"Entire home/apt"}],[{"value":"672.525"},{"value":"7"},{"value":"Entire home/apt"}],[{"value":"721.25"},{"value":"10"},{"value":"Entire home/apt"}],[{"value":"788.3846153846154"},{"value":"14"},{"value":"Entire home/apt"}],[{"value":"96.0"},{"value":"1"},{"value":"Shared room"}],[{"value":"750.0"},{"value":"21"},{"value":"Entire home/apt"}]],"columnNames":[{"name":"avg_price","index":0,"aggr":"sum"},{"name":"minimum_nights","index":1,"aggr":"sum"},{"name":"room_type","index":2,"aggr":"sum"}],"rows":[["141.5744680851064","1","Private room"],["150.44444444444446","2","Private room"],["66.0","3","Private room"],["103.33333333333333","4","Private room"],["86.0","5","Private room"],["149.0","7","Private room"],["110.0","14","Private room"],["433.3496932515337","2","Entire home/apt"],["397.4342105263158","1","Entire home/apt"],["429.0","3","Entire home/apt"],["561.6896551724138","4","Entire home/apt"],["487.5348837209302","5","Entire home/apt"],["786.0","6","Entire home/apt"],["672.525","7","Entire home/apt"],["721.25","10","Entire home/apt"],["788.3846153846154","14","Entire home/apt"],["96.0","1","Shared room"],["750.0","21","Entire home/apt"]]},"dateCreated":"2016-08-05T01:18:42+0000","dateStarted":"2016-08-05T01:42:45+0000","dateFinished":"2016-08-05T01:42:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8675","focus":true},{"dateUpdated":"2016-08-05T01:44:05+0000","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"minimum_nights","index":1,"aggr":"sum"}],"values":[{"name":"avg_price","index":0,"aggr":"sum"}],"groups":[{"name":"room_type","index":2,"aggr":"sum"}],"scatter":{"xAxis":{"name":"avg_price","index":0,"aggr":"sum"},"yAxis":{"name":"minimum_nights","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{"room_type":"Entire home/apt"},"forms":{"room_type":{"name":"room_type","defaultValue":"Private room","options":[{"value":"Private room","$$hashKey":"object:9478"},{"value":"Entire home/apt","$$hashKey":"object:9479"},{"value":"Shared room","$$hashKey":"object:9480"}],"hidden":false}}},"jobName":"paragraph_1470359922508_299016767","id":"20160805-005645_672910916","dateCreated":"2016-08-05T01:18:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8676","dateFinished":"2016-08-05T01:43:40+0000","dateStarted":"2016-08-05T01:43:38+0000","result":{"code":"SUCCESS","type":"TABLE","msg":"avg_price\tminimum_nights\troom_type\n397.4342105263158\t1\tEntire home/apt\n433.3496932515337\t2\tEntire home/apt\n429.0\t3\tEntire home/apt\n561.6896551724138\t4\tEntire home/apt\n487.5348837209302\t5\tEntire home/apt\n672.525\t7\tEntire home/apt\n786.0\t6\tEntire home/apt\n721.25\t10\tEntire home/apt\n788.3846153846154\t14\tEntire home/apt\n750.0\t21\tEntire home/apt\n","comment":"","msgTable":[[{"key":"minimum_nights","value":"397.4342105263158"},{"key":"minimum_nights","value":"1"},{"key":"minimum_nights","value":"Entire home/apt"}],[{"key":"room_type","value":"433.3496932515337"},{"key":"room_type","value":"2"},{"key":"room_type","value":"Entire home/apt"}],[{"value":"429.0"},{"value":"3"},{"value":"Entire home/apt"}],[{"value":"561.6896551724138"},{"value":"4"},{"value":"Entire home/apt"}],[{"value":"487.5348837209302"},{"value":"5"},{"value":"Entire home/apt"}],[{"value":"672.525"},{"value":"7"},{"value":"Entire home/apt"}],[{"value":"786.0"},{"value":"6"},{"value":"Entire home/apt"}],[{"value":"721.25"},{"value":"10"},{"value":"Entire home/apt"}],[{"value":"788.3846153846154"},{"value":"14"},{"value":"Entire home/apt"}],[{"value":"750.0"},{"value":"21"},{"value":"Entire home/apt"}]],"columnNames":[{"name":"avg_price","index":0,"aggr":"sum"},{"name":"minimum_nights","index":1,"aggr":"sum"},{"name":"room_type","index":2,"aggr":"sum"}],"rows":[["397.4342105263158","1","Entire home/apt"],["433.3496932515337","2","Entire home/apt"],["429.0","3","Entire home/apt"],["561.6896551724138","4","Entire home/apt"],["487.5348837209302","5","Entire home/apt"],["672.525","7","Entire home/apt"],["786.0","6","Entire home/apt"],["721.25","10","Entire home/apt"],["788.3846153846154","14","Entire home/apt"],["750.0","21","Entire home/apt"]]},"text":"%sql\nSELECT AVG(price) avg_price, minimum_nights, room_type\nFROM airbnb\nWHERE neighbourhood in ('Pittwater') and\n      room_type=\"${room_type=Private room,Private room|Entire home/apt|Shared room}\" \nGROUP BY room_type, minimum_nights\nORDER BY 1 DESC","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470361373745_-2087916148","id":"20160805-014253_1835061697","dateCreated":"2016-08-05T01:42:53+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9158"}],"name":"airbnb-sydney","id":"2BSCXMGJ9","angularObjects":{"2BUFT23S7:shared_process":[],"2BSU6C6E7:shared_process":[],"2BT2Z57U5:shared_process":[],"2BSTRTSNN:shared_process":[],"2BRHSDU5Y:shared_process":[],"2BUU367MT:shared_process":[],"2BSYFSZWG:shared_process":[],"2BS2PAW99:shared_process":[],"2BSYQW7G2:shared_process":[],"2BSSUBWE2:shared_process":[],"2BRNBW5F6:shared_process":[],"2BTB15TXE:shared_process":[],"2BTPQX9YQ:shared_process":[],"2BU2M7NEX:shared_process":[],"2BSHUYG6V:shared_process":[],"2BSQJFQS4:shared_process":[],"2BV72M8JP:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}